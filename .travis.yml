os:
  - windows
  - osx

language: shell

cache:
  directories:
    - $HOME/.m2

before_install:
  - set -e
  - |
    if [[ "$TRAVIS_OS_NAME" == "windows" ]]; then
      choco install jdk8
      export JAVA_HOME="C:/Program Files/Java/jdk1.8.0_211"
      RefreshEnv.cmd
      choco install maven
    fi
    |
    if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
      brew tap caskroom/versions
      brew cask install java8
      brew install maven
    fi

script:
  - mvn clean verify -Prun-its
  - mvn com.gavinmogan:codacy-maven-plugin:coverage -DcoverageReportFile=target/coverage-reports/jacoco/jacoco.xml
